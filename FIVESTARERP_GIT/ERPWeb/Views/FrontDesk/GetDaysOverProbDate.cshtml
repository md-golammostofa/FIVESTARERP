
@{
    ViewBag.Title = "Days Over";
    var privilege = (ERPBO.Common.UserPrivilege)ViewBag.UserPrivilege;
    string tab = Request.QueryString["tab"] != null ? Request.QueryString["tab"].ToString() : "";
}
<div class="row">
    <div class="col-md-12">
        <div class="card shadow card-primary card-outline card-tabs" style="margin-top:-20px">
            <div class="card-header p-0 pt-1 border-bottom-0">
                <ul class="nav nav-tabs nav-pills" id="custom-tabs-two-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="custom-tabs-two-jobOrder3daysList-tab" data-toggle="pill" href="#custom-tabs-two-jobOrder3daysList" role="tab" aria-controls="custom-tabs-two-jobOrder3daysList" aria-selected="true">5 Days</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="custom-tabs-two-jobOrder10daysList-tab" data-toggle="pill" href="#custom-tabs-two-jobOrder10daysList" role="tab" aria-controls="custom-tabs-two-jobOrder10daysList" aria-selected="false">10 Days</a>
                    </li>
                </ul>
            </div>
            <div class="card-body shadow">
                <div class="tab-content" id="custom-tabs-two-tabContent">
                    @Html.AntiForgeryToken()
                    <div class="tab-pane fade show active" id="custom-tabs-two-jobOrder3daysList" role="tabpanel" aria-labelledby="custom-tabs-two-jobOrder3daysList-tab">
                        <div class="row" style="margin-top:-15px">
                            <div class="col-md-12">
                                <div class="card shadow card-gray-dark">
                                    <div class="card-header shadow">
                                        <div class="row">
                                            <div class="col-md-4 text-left">

                                            </div>
                                            <div class="col-md-4">
                                                <h5 class="text-center text-bold">
                                                    Probabily Date 5 Days Over Job
                                                </h5>
                                            </div>
                                            <div class="col-md-4">
                                                
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="col-md-12">
                                            <div class="row text-sm">
                                                <div class="col-md-2">
                                                    <label class="col-form-label">Job Code</label>
                                                    <input type="text" id="txtJobCode" class="form-control form-control-sm" placeholder="Search By JobCode" name="jobCode" />
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">Model</label>
                                                    @Html.DropDownList("ddlModelName", (IEnumerable<SelectListItem>)ViewBag.ddlModelName, "Search By Model", new { @class = "form-control form-control-sm ctrl-changed select2 select2-danger ctrl-changed" })
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">IMEI1</label>
                                                    <input type="text" id="txtIMEINo" class="form-control form-control-sm" placeholder="Search By IMEI1" name="iMEI" />
                                                </div>
                                                <div class="col-md-2 hide">
                                                    <label class="col-form-label">IMEI2</label>
                                                    <input type="text" id="txtIMEI2No" class="form-control form-control-sm" placeholder="Search By IMEI2" name="iMEI2" />
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">Mobile No</label>
                                                    <input type="text" id="txtMobileNo" class="form-control form-control-sm" placeholder="Search By Mobile" name="mobile" />
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">Job Type</label>
                                                    @Html.DropDownList("ddlJobType", (IEnumerable<SelectListItem>)ViewBag.ddlJobType, "--Search By Job Type--", new { @class = "form-control form-control-sm ctrl-changed select2 select2-danger ctrl-changed " })
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">PDStatus</label>
                                                    <select name="pdStatus" id="ddlPdStatus" class="form-control form-control-sm">
                                                        <option value="" selected>Search By One</option>
                                                        <option value="Pending">Pending</option>
                                                        <option value="Delivery">Delivery</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row text-sm">
                                                <div class="col-md-2">
                                                    <label class="col-form-label">Customer Type</label>
                                                    @Html.DropDownList("ddlCustomerType", (IEnumerable<SelectListItem>)ViewBag.ddlCustomerType, "--Search By CustomerType--", new { @class = "form-control form-control-sm ctrl-changed " })
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">Dealer</label>
                                                    @Html.DropDownList("txtCustomerName", (IEnumerable<SelectListItem>)ViewBag.txtCustomerName, "--Search By Dealer--", new { @class = "form-control form-control-sm ctrl-changed select select2" })
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">Job Status</label>
                                                    @Html.DropDownList("ddlStateStatus", (IEnumerable<SelectListItem>)ViewBag.ddlStateStatus, "--Search By Status--", new { @class = "form-control form-control-sm ctrl-changed " })
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">Receive Id</label>
                                                    <input type="text" id="txtReceiveId" class="form-control form-control-sm" placeholder="Search By Receive Id" name="recId" />
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">From Date</label>
                                                    <div class="input-group input-group-sm ">
                                                        <input type="text" class="form-control form-control-sm date-datePicker ctrl-changed" id="dptFromDate" name="fromDate" />
                                                        <div class="input-group-prepend cursor-pointer remove-date dptFromDate" style="cursor:pointer">
                                                            <span class="input-group-text">&#10008;</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="col-form-label">To Date</label>
                                                    <div class="input-group input-group-sm ">
                                                        <input type="text" class="form-control form-control-sm date-datePicker ctrl-changed" id="dptToDate" name="toDate" />
                                                        <div class="input-group-prepend remove-date dptToDate" style="cursor:pointer">
                                                            <span class="input-group-text">&#10008;</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-1 hide" id="divReportType">
                                                    <label class="col-form-label" for="rptType">Type</label>
                                                    <select name="rptType" id="rptType" class="form-control form-control-sm">
                                                        <option value="PDF">PDF</option>
                                                        <option value="EXCEL">EXCEL</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-1 hide" id="divbtnReport">
                                                    <label class="col-form-label" for="Download" style="visibility:hidden">Download</label>
                                                    <button type="submit" title="Download Dealer Receipt" class="btn btn-sm btn-outline-danger"><i class="fas fa-file-pdf"> </i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12" style="margin-top:-15px">
                                <div class="card shadow card-navy">
                                    <div class="card-body text-sm">
                                        <div class="col-md-12 text-sm text-sm" id="dataContainer" style="overflow-y:scroll">
                                            @{Html.RenderAction("GetDaysOverProbDate", new { @flag = "view" });}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade show" id="custom-tabs-two-jobOrder10daysList" role="tabpanel" aria-labelledby="custom-tabs-two-jobOrder10daysList-tab">
                        <div class="row" style="margin-top:-15px">
                            <div class="col-md-12">
                                <div class="card shadow card-gray-dark">
                                    <div class="card-header shadow">
                                        <div class="row">
                                            <div class="col-md-3">
                                            </div>
                                            <div class="col-md-6">
                                                <h5 class="text-center text-bold">
                                                    Probabily Date 10 Days Over List
                                                </h5>
                                            </div>
                                            <div class="col-md-3">
                                                
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12" style="margin-top:-10px">
                                <div class="card shadow card-navy">
                                    <div class="card-body text-sm">
                                        <div class="row text-sm">
                                            <div class="col-md-2">
                                                <label class="col-form-label">Job Code</label>
                                                <input type="text" id="txtJobCode2" class="form-control form-control-sm" placeholder="Search By JobCode" name="jobCode" />
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">Model</label>
                                                @Html.DropDownList("ddlModelName2", (IEnumerable<SelectListItem>)ViewBag.ddlModelName, "Search By Model", new { @class = "form-control form-control-sm ctrl-changed select2 select2-danger ctrl-changed" })
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">IMEI1</label>
                                                <input type="text" id="txtIMEINo2" class="form-control form-control-sm" placeholder="Search By IMEI1" name="iMEI" />
                                            </div>
                                            <div class="col-md-2 hide">
                                                <label class="col-form-label">IMEI2</label>
                                                <input type="text" id="txtIMEI2No2" class="form-control form-control-sm" placeholder="Search By IMEI2" name="iMEI2" />
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">Mobile No</label>
                                                <input type="text" id="txtMobileNo2" class="form-control form-control-sm" placeholder="Search By Mobile" name="mobile" />
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">Job Type</label>
                                                @Html.DropDownList("ddlJobType2", (IEnumerable<SelectListItem>)ViewBag.ddlJobType, "--Search By Job Type--", new { @class = "form-control form-control-sm ctrl-changed select2 select2-danger ctrl-changed " })
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">PDStatus</label>
                                                <select name="pdStatus" id="ddlPdStatus2" class="form-control form-control-sm">
                                                    <option value="" selected>Search By One</option>
                                                    <option value="Pending">Pending</option>
                                                    <option value="Delivery">Delivery</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="row text-sm">
                                            <div class="col-md-2">
                                                <label class="col-form-label">Customer Type</label>
                                                @Html.DropDownList("ddlCustomerType2", (IEnumerable<SelectListItem>)ViewBag.ddlCustomerType, "--Search By CustomerType--", new { @class = "form-control form-control-sm ctrl-changed " })
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">Dealer</label>
                                                @Html.DropDownList("txtCustomerName2", (IEnumerable<SelectListItem>)ViewBag.txtCustomerName, "--Search By Dealer--", new { @class = "form-control form-control-sm ctrl-changed select select2" })
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">Job Status</label>
                                                @Html.DropDownList("ddlStateStatus2", (IEnumerable<SelectListItem>)ViewBag.ddlStateStatus, "--Search By Status--", new { @class = "form-control form-control-sm ctrl-changed " })
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">Receive Id</label>
                                                <input type="text" id="txtReceiveId2" class="form-control form-control-sm" placeholder="Search By Receive Id" name="recId" />
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">From Date</label>
                                                <div class="input-group input-group-sm ">
                                                    <input type="text" class="form-control form-control-sm date-datePicker ctrl-changed" id="dptFromDate2" name="fromDate" />
                                                    <div class="input-group-prepend cursor-pointer remove-date dptFromDate2" style="cursor:pointer">
                                                        <span class="input-group-text">&#10008;</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <label class="col-form-label">To Date</label>
                                                <div class="input-group input-group-sm ">
                                                    <input type="text" class="form-control form-control-sm date-datePicker ctrl-changed" id="dptToDate2" name="toDate" />
                                                    <div class="input-group-prepend remove-date dptToDate2" style="cursor:pointer">
                                                        <span class="input-group-text">&#10008;</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" style="margin-top:-10px">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-12 text-sm text-sm" id="dataContainer3" style="overflow-y:scroll">
                                                @{Html.RenderAction("Get10DaysOverProbDate", new { @flag = "view" });}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalJobOrderDetails" role="dialog" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header alert-secondary" style="height:60px">
                @Html.AntiForgeryToken()
                <input type="hidden" id="hdfJobOrderId" />
                <h4 id="modalHeading" class="modal-title">Job Order Details</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body" id="dataContainer2">
            </div>
        </div>
    </div>
</div>
@section scripts{
    <script type="text/javascript">
        var pageNo = 1;
        var ddlModelName = $("#ddlModelName");
        var txtMobileNo = $("#txtMobileNo");
        var ddlStateStatus = $("#ddlStateStatus");
        var txtJobCode = $("#txtJobCode");
        var hdfJobOrderId = $("#hdfJobOrderId");
        var txtIMEINo = $("#txtIMEINo");
        var txtIMEI2No = $("#txtIMEI2No");
        var txtReceiveId = $("#txtReceiveId");
        var ddlCustomerType = $("#ddlCustomerType");
        var ddlJobType = $("#ddlJobType");
        var txtCustomerName = $("#txtCustomerName");
        var ddlPdStatus = $("#ddlPdStatus");
        var dptFromDate = $("#dptFromDate");
        var dptToDate = $("#dptToDate");
        //
        var ddlModelName2 = $("#ddlModelName2");
        var txtMobileNo2 = $("#txtMobileNo2");
        var ddlStateStatus2 = $("#ddlStateStatus2");
        var txtJobCode2 = $("#txtJobCode2");
        var hdfJobOrderId2 = $("#hdfJobOrderId2");
        var txtIMEINo2 = $("#txtIMEINo2");
        var txtIMEI2No2 = $("#txtIMEI2No2");
        var txtReceiveId2 = $("#txtReceiveId2");
        var ddlCustomerType2 = $("#ddlCustomerType2");
        var ddlJobType2 = $("#ddlJobType2");
        var txtCustomerName2 = $("#txtCustomerName2");
        var ddlPdStatus2 = $("#ddlPdStatus2");
        var dptFromDate2 = $("#dptFromDate2");
        var dptToDate2 = $("#dptToDate2");

        $(document).ready(function () {
            dptFromDate.prop('readonly', true);
            dptToDate.prop('readonly', true);
            dptFromDate2.prop('readonly', true);
            dptToDate2.prop('readonly', true);
            dptFromDate.css("background-color", "#fff");
            dptToDate.css("background-color", "#fff");
            dptFromDate2.css("background-color", "#fff");
            dptToDate2.css("background-color", "#fff");
            $('#dptFromDate').datepicker({
                format: "dd MM yyyy",
                orientation: "bottom auto",
                todayHighlight: true,
                autoclose: true,
                showOn: "button",
                buttonImageOnly: true,
            });
            $('#dptToDate').datepicker({
                format: "dd MM yyyy",
                orientation: "bottom auto",
                todayHighlight: true,
                autoclose: true
            });
            $('#dptFromDate2').datepicker({
                format: "dd MM yyyy",
                orientation: "bottom auto",
                todayHighlight: true,
                autoclose: true,
                showOn: "button",
                buttonImageOnly: true,
            });
            $('#dptToDate2').datepicker({
                format: "dd MM yyyy",
                orientation: "bottom auto",
                todayHighlight: true,
                autoclose: true
            });
        })

        $(document).on('click', 'div.remove-date', function () {
            if ($(this).hasClass("dptToDate")) {
                if (dptToDate.val() !== '') {
                    dptToDate.val('');
                    LoadDataTable();
                }
            }
            if ($(this).hasClass("dptFromDate")) {
                if (dptFromDate.val() !== '') {
                    dptFromDate.val('');
                    LoadDataTable();
                }
            }
            if ($(this).hasClass("dptToDate2")) {
                if (dptToDate2.val() !== '') {
                    dptToDate2.val('');
                    LoadDataTable2();
                }
            }
            if ($(this).hasClass("dptFromDate2")) {
                if (dptFromDate2.val() !== '') {
                    dptFromDate2.val('');
                    LoadDataTable2();
                }
            }

        })

        dptFromDate.change(function () {
            LoadDataTable();
        })
        dptToDate.change(function () {
            LoadDataTable();
        })
        $(document).ready(function () {
            //Initialize Select2 Elements
            $('.select2').select2();

            //Initialize Select2 Elements
            $('.select2bs4').select2({
                theme: 'bootstrap4'
            });
        })

        txtMobileNo.keyup(function () {
            LoadDataTable();
        })
        txtJobCode.keyup(function () {
            LoadDataTable();
        })
        txtIMEINo.keyup(function () {
            LoadDataTable();
        })
        txtIMEI2No.keyup(function () {
            LoadDataTable();
        })
        txtCustomerName.change(function () {
            LoadDataTable();
        })
        txtReceiveId.keyup(function () {
            LoadDataTable();
        })
        ddlPdStatus.change(function () {
            LoadDataTable();
        })

        $(document).on('change', '.ctrl-changed', function () {
            LoadDataTable();
        })

        function LoadDataTable() {
            var data = { flag: "search", modelId: TryParseInt(ddlModelName.val(), 0), jobOrderId: 0, mobileNo: $.trim(txtMobileNo.val()), status: ddlStateStatus.val(), jobCode: txtJobCode.val(), iMEI: txtIMEINo.val(), iMEI2: txtIMEI2No.val(), fromDate: dptFromDate.val(), toDate: dptToDate.val(), customerType: ddlCustomerType.val(), jobType: ddlJobType.val(), customer: txtCustomerName.val().trim(), recId: txtReceiveId.val(), pdStatus: ddlPdStatus.val(), page: pageNo };

            console.log(data);
            $.when(getReqWithData('html', 'GET', '/FrontDesk/GetDaysOverProbDate', data)).then(function (res, status) {
                console.log(status);
                if (status === "success") {
                    $("#dataContainer").fadeOut('500', function () {
                        $("#dataContainer").empty();
                        $("#dataContainer").append(res).fadeIn('500');
                    });
                }
            }).fail(function (error) {
                console.log(error);
            });
        }
        //2 No

        dptFromDate2.change(function () {
            LoadDataTable2();
        })
        dptToDate2.change(function () {
            LoadDataTable2();
        })

        txtMobileNo2.keyup(function () {
            LoadDataTable2();
        })
        txtJobCode2.keyup(function () {
            LoadDataTable2();
        })
        txtIMEINo2.keyup(function () {
            LoadDataTable2();
        })
        txtIMEI2No2.keyup(function () {
            LoadDataTable2();
        })
        txtCustomerName2.change(function () {
            LoadDataTable2();
        })
        txtReceiveId2.keyup(function () {
            LoadDataTable2();
        })
        ddlPdStatus2.change(function () {
            LoadDataTable2();
        })

        $(document).on('change', '.ctrl-changed', function () {
            LoadDataTable2();
        })

        function LoadDataTable2() {
            var data = { flag: "search", modelId: TryParseInt(ddlModelName2.val(), 0), jobOrderId: 0, mobileNo: $.trim(txtMobileNo2.val()), status: ddlStateStatus2.val(), jobCode: txtJobCode2.val(), iMEI: txtIMEINo2.val(), iMEI2: txtIMEI2No2.val(), fromDate: dptFromDate2.val(), toDate: dptToDate2.val(), customerType: ddlCustomerType2.val(), jobType: ddlJobType2.val(), customer: txtCustomerName2.val().trim(), recId: txtReceiveId2.val(), pdStatus: ddlPdStatus2.val(), page: pageNo };

            console.log(data);
            $.when(getReqWithData('html', 'GET', '/FrontDesk/Get10DaysOverProbDate', data)).then(function (res, status) {
                console.log(status);
                if (status === "success") {
                    $("#dataContainer3").fadeOut('500', function () {
                        $("#dataContainer3").empty();
                        $("#dataContainer3").append(res).fadeIn('500');
                    });
                }
            }).fail(function (error) {
                console.log(error);
            });
        }

        $(document).on('click', 'a.data-item-details', function (e) {
            e.preventDefault();
            var id = $(this).attr("data-item-details");
            getJobOrderDetail("Detail", id)

        })

        function getJobOrderDetail(flag, id) {
            hdfJobOrderId.val("0");
            if (TryParseInt(id) > 0) {
                hdfJobOrderId.val(id)
                var data = { flag: flag, jobOrderId: id };

                console.log(data);
                $.when(getReqWithData('html', 'GET', '/FrontDesk/GetJobOrder3DaysDetails', data)).then(function (res, status) {
                    console.log(status);
                    if (status === "success") {
                        $("#dataContainer2").empty();
                        $("#dataContainer2").append(res).fadeIn('500');
                        $("#modalJobOrderDetails").modal("show");
                    }
                }).fail(function (error) {
                    console.log(error);
                });
            }
        }
    </script>
    }